(**Causal constant coefficient differential equations: Laplace transform**)

$D$ denotes derivative in differential equations.
$$
L = a_k D^k + \cdots + a_1 D + a_0; \quad a_k \neq 0
$$
For $f \in C^k([0, \infty) \to \C)$ we have $L f(t) = a_k f^{(k)}(t) + \cdots + a_0 f(t)$.

Consider differential equation $Lf(t) = 0$. With initial conditions $\p{f(0), f'(0), \ldots, f^{(k - 1)}(0)}$.

Suppose $f$ has Laplace transform $F(s)$ on $\re s > \sigma_f$. Then
$$
\l[L(f)](s) = \p{a_k s^k + \cdots + a_1 s + a_0} F(s) = I(s)
$$
where $I(s) \in \C[s]$ with $\deg I < k$, coefficients are linear in initial conditions.

- $\l[f](s) = F(s)$.
- $\l[f'](s) = sF(s) - f(0)$.
- $\l[f''](s) = s^2 F(s) - s f(0) - f'(0)$. And so on.

Now we have $F(s) \in \C[s]$,
$$
F(s) = \frac{I(s)}{\p{a_k s^k + \cdots + a_1 s + a_0}}
$$

Suppose $\c{p_1, \ldots, p_n}$ are distinct poles of $F$ with order $\c{d_1, \ldots, d_n}$, $n \le k$.

Therefore $F(s)$ can be decomposed into the following:
$$
F(s) = \sum_{k = 1}^n g_k\p{\frac{1}{s - p_k}}; \quad \deg g_k = d_k
$$
To find $f(t)$, we only need to find the Laplace inverse of $c / (s - p)^d$.
$$
\l\s{\frac{t^{d - 1}e^{pt}}{(d - 1)!}}(s) = \frac{1}{(s - p)^d}
$$

(**Causal constant coefficient differential equations: Guessing method**)

Continue above discussion.

The roots of $a_k s^k + \cdots + a_0 = 0$ are the poles of $F(s)$.

$f(t)$ is the linear combination of the following functions:

- Suppose $p$ is a root of order $d$, then $e^{pt}, te^{pt}, \ldots, t^{d - 1} e^{pt}$.

Now determine the weights of linear combination by initial conditions.

(**Laplace transform reference table**)

The following are considered on $[0, \infty)$.

| Original function                   | Laplace Transform                        | Comment                                 |
| ----------------------------------- | ---------------------------------------- | --------------------------------------- |
| $1$                                 | $1/s$                                    | Direct computation.                     |
| $t^n$                               | $n!/s^{n+1} = \Gamma(n + 1) / s^{n + 1}$ | Frequency differentiation of $1/s$.     |
| $t^n e^{\alpha t}$                  | $n!/(s - \alpha)^{n + 1}$                | Frequency shifting of above.            |
| $e^{\alpha t}$                      | $1 / (s - \alpha)$                       | Frequency shifting of above.            |
| $\sin t = (-i/2)(e^{it} - e^{-it})$ | $1 / (s^2 + 1)$                          | Linearity.                              |
| $\cos t = (1/2)(e^{it} + e^{-it})$  | $s / (s^2 + 1)$                          | Linearity. Or derivative of $\cos (t)$. |

During the lecture, these transforms are computed by brute force.

(**Causal constant coefficient difference equations**)

Let $E$ be the shift left operator $f(n) \mapsto f(n + 1)$. Consider operator
$$
L := a_k E^k + \cdots + a_1 E + a_0; \quad a_k \neq 0
$$
We have $L f[n] = a_k f[n + k] + \cdots + a_0 f[n]$.

Consider difference equation $Lf[n] = 0$. With initial conditions $f[0], \ldots, f[k - 1]$.

Suppose $F(z) = \sum_{n = 0}^\infty f(n)z^n$. Multiply by $z^n$ and sum from $n = 0 \to \infty$ we have:
$$
\p{a_k z^{-k} + \cdots + a_1 z^{-1} + a_0} F(z) = I(z^{-1})
$$
where $I(z) \in \C[z]$ with $\deg I(z) < k$, with coefficients linear in initial conditions.

- $\sum_{n = 0}^\infty f(n + k)z^n = \s{F(z) - \sum_{n = 0}^{k - 1} f(n) z^n} / z^k$.

$$
F(z) = z^{-1}\frac{I(z^{-1})}{\p{a_k z^{-k} + \cdots + a_1 z^{-1} + a_0}}
$$
Suppose $\c{p_1, \ldots, p_n, \infty}$ are distinct poles of $F(z^{-1})$ with order $\c{d_1, \ldots, d_n}$.

Therefore $F(z)$ can be decomposed into the following:
$$
F(z) = z^{-1} \sum_{k = 1}^n g_k\p{\frac{1}{z^{-1} - p_k}};\quad \deg g_k = d_k
$$
To find $f(t)$, we only need to find the original function of $z^{-1} / (z^{-1} - p)^d$.
$$
\frac{z^{-1}}{\p{z^{-1} - p}^d} = \frac{z^{d - 1}}{(1 - pz)^d} = p^{-(d - 1)}\frac{(pz)^{d - 1}}{(1 - pz)^d}
$$

- This is generated by $u[n] * u[n - 1] * \cdots * u[n - 1]$, integral $d - 1$ times.
- Then multiplied by $p^n$.
- So $f(n)$ is the linear combination of $\c{1, \ldots, n^{d - 1}}$.

(**Causal constant coefficient difference equations: Guessing**)

Continue above discussion.

Suppose the roots of $a_k s^k + \cdots + a_0 = 0$ are $\c{p_1, \ldots, p_n}$ of degree $\c{d_1, \ldots, d_n}$.

$f(n)$ is the linear combination of the following functions:

- Suppose $p$ is a root of order $d$, then $p^n, np^{n}, \ldots, n^{d - 1}p^n$.

Now determine the weights of linear combination by initial conditions.

(**Z transform reference table**)

Consider sequences in $\ell(\N)$.

| Original function | Z transform                                                  | Comment                                                    |
| ----------------- | ------------------------------------------------------------ | ---------------------------------------------------------- |
| $u[n]$            | $z^{-1} / (z^{-1} - 1) = 1 / (1 - z)$                        | The most basic power series.                               |
| $u[n - 1]$        | $1 / (z^{-1} - 1) = z / (1 - z)$                             | Dropping the first element.                                |
| $\alpha^n$        | $z^{-1} / (z^{-1} - \alpha) = 1 / (1 - \alpha z)$.           | By definition.                                             |
| $n$               | $z / (1 - z)^2 = z^{-1}/(z^{-1} - 1)^2$                      | Differentiation by term. Or through convolution.           |
| $n^2$             | $z^2 / (1 - z)^3$                                            | Through convolution.                                       |
| $n \alpha^n$      | $\alpha z / (1 - \alpha z)^2 = \alpha z^{-1}/(z^{-1} - \alpha)^2$ | Differentiation by term; replacement $z \mapsto \alpha z$. |

